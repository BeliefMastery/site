<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manipulation Defense Decoder</title>
  <meta name="description" content="Identify manipulation tactics and vectors through comprehensive symptom, effect, and consequence analysis. Includes countermeasures and defense strategies.">
  <meta name="keywords" content="manipulation analysis, cognitive defense, sovereignty, manipulation tactics, manipulation vectors, belief mastery, sovereign of mind">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://beliefmastery.github.io/site/manipulation.html">
  <meta property="og:title" content="Manipulation Defense Decoder">
  <meta property="og:description" content="Identify manipulation tactics and vectors through comprehensive symptom, effect, and consequence analysis. Includes countermeasures and defense strategies.">
  <meta property="og:image" content="https://beliefmastery.github.io/site/images/manipulation-analysis-cover.jpg">
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://beliefmastery.github.io/site/manipulation.html">
  <meta name="twitter:title" content="Manipulation Defense Decoder">
  <meta name="twitter:description" content="Identify manipulation tactics and vectors through comprehensive symptom, effect, and consequence analysis. Includes countermeasures and defense strategies.">
  <meta name="twitter:image" content="https://beliefmastery.github.io/site/images/manipulation-analysis-cover.jpg">
  
  <!-- CRITICAL: Universal styles MUST load first -->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="./shared/background.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  
  <!-- Resource hints for performance -->
  <link rel="modulepreload" href="./manipulation-engine.js">
  <link rel="modulepreload" href="./shared/data-loader.js">
  <link rel="modulepreload" href="./shared/debug-reporter.js">
  <link rel="modulepreload" href="./shared/utils.js">
  <link rel="modulepreload" href="./shared/performance-monitor.js">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

</head>
<body>

  <!-- Cosmic background (from universal system) -->
  <div class="bg-gradient"></div>
  <canvas id="nebula-canvas" aria-hidden="true"></canvas>

  <header class="site-header" role="banner">
    <nav class="nav" aria-label="Primary navigation">
      <button class="hamburger" aria-expanded="false" aria-controls="top-nav" aria-label="Toggle navigation">‚ò∞</button>
      <ul class="nav-list" id="top-nav" role="menubar">
        <li role="none"><a role="menuitem" href="index.html">Home</a></li>
        <li role="none" class="nav-dropdown">
          <a role="menuitem" href="books.html" class="dropdown-toggle">Books <span>&#9660;</span></a>
          <ul class="dropdown-menu" role="menu">
            <li role="none"><a role="menuitem" href="books.html">All Books</a></li>
            <li role="none"><a role="menuitem" href="books.html#belief-mastery">Belief Mastery</a></li>
            <li role="none"><a role="menuitem" href="books.html#sovereign-of-mind">Sovereign of Mind</a></li>
            <li role="none"><a role="menuitem" href="books.html#distortion-codex">Distortion Codex</a></li>
            <li role="none"><a role="menuitem" href="books.html#unspeakables-grimoire">The Unspeakables Grimoire</a></li>
            <li role="none"><a role="menuitem" href="books.html#sovereign-integral-devotionalism">Sovereign Integral Devotionalism</a></li>
            <li role="none"><a role="menuitem" href="books.html#peer-counseling-manual">Peer-Counseling Manual</a></li>
          </ul>
        </li>
        <li role="none" class="nav-dropdown">
          <a role="menuitem" href="tools.html" class="dropdown-toggle active">Tools <span>&#9660;</span></a>
          <ul class="dropdown-menu" role="menu">
            <li role="none"><a role="menuitem" href="tools.html">All Tools</a></li>
            <li role="none"><a role="menuitem" href="diagnosis.html">Pathology Assessment</a></li>
            <li role="none"><a role="menuitem" href="coaching.html">Life Domain Review</a></li>
            <li role="none"><a role="menuitem" href="needs-dependency.html">Dependency Loop Tracer</a></li>
            <li role="none"><a role="menuitem" href="manipulation.html" class="active">Manipulation Defense Decoder</a></li>
            <li role="none"><a role="menuitem" href="sovereignty-spectrum.html">Your Sovereignty Paradigm</a></li>
            <li role="none"><a role="menuitem" href="paradigm.html">Logos Structure</a></li>
            <li role="none"><a role="menuitem" href="relationship.html">Relationship Bottleneck Analysis</a></li>
            <li role="none"><a role="menuitem" href="temperament.html">Polarity Position Mapping</a></li>
            <li role="none"><a role="menuitem" href="archetype.html">Modern Archetype Identification</a></li>
            <li role="none"><a role="menuitem" href="channels.html">Channel Flow Diagnostics</a></li>
            <li role="none"><a role="menuitem" href="character-sheet.html">Astrological Character Sheet</a></li>
            <li role="none"><a role="menuitem" href="https://chatgpt.com/g/g-684212ba47e081918d000ec3f9cf8f69-simulacrum-exorcist-edition" target="_blank">Unlocked GPT</a></li>
            <li role="none"><a role="menuitem" href="sovereignty.html">Cognitive Resistance Capacity</a></li>
          </ul>
        </li>
        <li role="none"><a role="menuitem" href="about-the-author.html">About the Author</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <!-- Universal Tool Container -->
    <div class="manipulation-container">
      
      <!-- Hero Image Section -->
      <div class="hero-image">
        <img src="./images/manipulation-analysis-cover.jpg" alt="Manipulation Defense Decoder" class="hero-img">
      </div>
      
      <!-- Intro Section -->
      <section class="intro-section" id="introSection">
        <h2>üîç Manipulation Defense Decoder</h2>
        
        <p class="lead-text">
          Are you being manipulated? Recognize the patterns and tactics being used against you. Identify the vectors and reclaim your sovereignty!
        </p>
        
        <p>This system guides you through questions about symptoms, effects, situational developments, and consequences to identify which manipulation vectors show patterns consistent with your experiences. Based on the <strong>Tactical Manipulation Compendium</strong> from <em>Sovereign of Mind</em>, this tool helps you recognize patterns of coercion, control, and psychological sabotage.</p>

        <!-- Extended Explanation Toggle -->
        <div class="extended-explanation-toggle" id="extendedExplanationToggle">
          <div class="extended-explanation-toggle-text">
            <span>Extended Explanation</span>
          </div>
        </div>

        <div class="extended-explanation-panel" id="extendedExplanationPanel">
          <div class="content-section">
            <!-- Warning Box (red border) -->
            <div class="ack-box error-box">
              <p>
                <strong>Epistemic Note:</strong> This system identifies manipulation patterns based on reported effects. It does not determine intent, morality, or full relational context. The analysis maps patterns consistent with manipulation vectors‚Äînot accusations of manipulator identity.
              </p>
            </div>
            
            <p><strong>Identify patterns consistent with manipulation through comprehensive symptom, effect, and consequence analysis.</strong></p>
            
            <p class="feature-list-header">The assessment covers:</p>
            <ul class="feature-list">
              <li><strong>Symptoms:</strong> Emotional, behavioral, cognitive, relational, and physical indicators</li>
              <li><strong>Effects:</strong> Impact on self-worth, autonomy, relationships, and daily functioning</li>
              <li><strong>Consequences:</strong> Situational developments and long-term consequences</li>
            </ul>
          </div>
        </div>
        
        <!-- Disclaimer Toggle -->
        <div class="disclaimer-acknowledgement" id="disclaimerToggle">
          <div class="disclaimer-acknowledgement-text">
            <span>Disclaimer</span>
          </div>
        </div>

        <section class="disclaimer-section" id="disclaimerSection">
          <div class="acknowledgement-box">
            <h3>Important Note</h3>
            <p><strong>This tool is designed for self-awareness and recognition.</strong></p>
            <p>Understanding manipulation patterns is the first step toward reclaiming sovereignty. Use this knowledge responsibly - awareness without integrity can become a tool of control.</p>
          </div>
        </section>
      </section>

      <!-- Assessment Selection Section -->
      <section class="content-section" id="actionButtonsSection">
        <div class="action-buttons">
          <a href="example-reports/manipulation-example.html" target="_blank" class="btn btn-secondary">View Example Report</a>
          <button class="btn btn-primary" id="startAssessment">Begin Manipulation Assessment</button>
          <button class="btn btn-secondary" id="clearCacheBtn">üîÑ Reset Data</button>
        </div>
      </section>

      <!-- Questionnaire Section -->
      <section class="questionnaire-section" id="questionnaireSection">
        <!-- Instructions Toggle -->
        <div class="instructions-toggle" id="instructionsToggle">
          <div class="instructions-toggle-text">
            <span>‚ùì How to Use This Assessment</span>
          </div>
        </div>
        
        <div class="instructions-panel" id="instructionsPanel">
          <h3>‚ùì How to Use This Assessment</h3>
          <div class="instructions-content">
            <p class="scale-guide"><strong>Understanding the Scale (0-10):</strong></p>
            <ul class="scale-list">
              <li><strong>0-2 (Not at all / Never):</strong> The statement does not apply to you at all.</li>
              <li><strong>3-4 (Minimal / Rarely):</strong> The statement occurs occasionally but has minimal impact.</li>
              <li><strong>5-6 (Moderate / Sometimes):</strong> The statement is present with moderate frequency or intensity.</li>
              <li><strong>7-8 (Significant / Often):</strong> The statement occurs frequently or with significant intensity.</li>
              <li><strong>9-10 (Extreme / Always):</strong> The statement is nearly constant or extremely intense.</li>
            </ul>
            <p class="guidelines"><strong>Guidelines:</strong></p>
            <ul class="guidelines-list">
              <li>Answer based on your experience in the relationship(s) you're analyzing</li>
              <li>Be honest - recognition is the first step to protection</li>
              <li>Consider how each pattern affects your autonomy and well-being</li>
              <li>You can go back and change answers using the "Previous" button</li>
            </ul>
          </div>
        </div>

        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <div id="questionContainer">
          <!-- Questions populated by JavaScript -->
        </div>
        
        <div class="navigation-buttons">
          <button class="btn btn-secondary" id="prevQuestion" disabled>Previous</button>
          <button class="btn btn-primary" id="nextQuestion">Next</button>
        </div>
        
        <div class="abandon-link">
          <button class="btn btn-secondary" id="abandonAssessment">‚ùå Abandon / Restart</button>
        </div>
      </section>

      <!-- Results Section -->
      <section class="results-section" id="resultsSection">
        <h2>Manipulation Vector Analysis</h2>
        <div id="vectorResults">
          <!-- Results populated by JavaScript -->
        </div>
        
        <!-- Debug Report Container -->
        <div id="debug-report" class="hidden"></div>
        
        <div class="export-section">
          <h3>Export Your Analysis</h3>
          <p>Export your analysis for reference or professional consultation.</p>
          <div class="action-buttons">
            <button class="btn btn-primary" id="exportAnalysisJson">üì• Export Analysis (JSON)</button>
            <button class="btn btn-primary" id="exportAnalysisCsv">üì• Export Analysis (CSV)</button>
            <button class="btn btn-secondary" id="newAssessment">Start New Assessment</button>
          </div>
        </div>
      </section>
    </div>
  </main>

  <footer>
    <p>&copy; 2025 Warwick Marshall. All rights reserved.</p>
  </footer>

  <!-- Universal background JavaScript -->
  <script src="./shared/background.js"></script>

  <script type="module">
    // Import performance monitoring and utilities
    import { initializePerformanceMonitoring } from './shared/performance-monitor.js';
    
    // Initialize performance monitoring
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        initializePerformanceMonitoring();
      });
    } else {
      initializePerformanceMonitoring();
    }
    
    // Show debug report container if debug mode is enabled
    if (window.location.search.includes('debug=true')) {
      const debugContainer = document.getElementById('debug-report');
      if (debugContainer) {
        debugContainer.style.display = 'block';
      }
    }
    
    // Import and initialize engine
    import('./manipulation-engine.js').then(module => {
      const { ManipulationEngine } = module;
      
      function initEngine() {
        window.manipulationEngine = new ManipulationEngine();
      }
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initEngine);
      } else {
        initEngine();
      }
    }).catch(error => {
      console.error('Failed to load manipulation engine:', error);
    });
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Toggle helper function
      const setupToggle = (btnId, panelId) => {
        const btn = document.getElementById(btnId);
        const panel = document.getElementById(panelId);
        if (btn && panel) {
          btn.addEventListener('click', () => {
            btn.classList.toggle('expanded');
            panel.classList.toggle('expanded');
          });
        }
      };

      // Setup toggles
      setupToggle('disclaimerToggle', 'disclaimerSection');
      setupToggle('extendedExplanationToggle', 'extendedExplanationPanel');
      setupToggle('instructionsToggle', 'instructionsPanel');

      // Hamburger menu
      const hamburger = document.querySelector('.hamburger');
      const nav = document.querySelector('#top-nav');
      
      if (hamburger && nav) {
        hamburger.addEventListener('click', function() {
          const isExpanded = hamburger.getAttribute('aria-expanded') === 'true';
          hamburger.setAttribute('aria-expanded', !isExpanded);
          nav.classList.toggle('active');
        });
      }

      // Dropdown menu
      const dropdownToggles = document.querySelectorAll('.nav-dropdown .dropdown-toggle');
      
      if (dropdownToggles.length) {
        dropdownToggles.forEach(toggle => {
          toggle.addEventListener('click', function(e) {
            e.preventDefault();
            const dropdown = toggle.closest('.nav-dropdown');
            if (dropdown) {
              document.querySelectorAll('.nav-dropdown').forEach(dd => {
                if (dd !== dropdown) {
                  dd.classList.remove('active');
                }
              });
              dropdown.classList.toggle('active');
            }
          });
        });

        document.addEventListener('click', function(e) {
          if (!e.target.closest('.nav-dropdown')) {
            document.querySelectorAll('.nav-dropdown').forEach(dd => {
              dd.classList.remove('active');
            });
          }
        });
      }
      
      // Debug panel functionality
      const debugToggle = document.getElementById('debugToggle');
      const debugPanel = document.getElementById('debugPanel');
      const debugClose = document.getElementById('debugClose');
      const debugClear = document.getElementById('debugClear');
      const debugLog = document.getElementById('debugLog');
      
      if (debugToggle && debugPanel) {
        debugToggle.addEventListener('click', function() {
          debugPanel.classList.toggle('active');
        });
        
        if (debugClose) {
          debugClose.addEventListener('click', function() {
            debugPanel.classList.remove('active');
          });
        }
        
        if (debugClear && debugLog) {
          debugClear.addEventListener('click', function() {
            debugLog.innerHTML = '';
            if (window.manipulationEngine) {
              window.manipulationEngine.debugLog = [];
            }
          });
        }
      }
      
      // Debug mode keyboard shortcut
      document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
          e.preventDefault();
          if (window.manipulationEngine) {
            window.manipulationEngine.debugMode = !window.manipulationEngine.debugMode;
            console.log('Debug mode:', window.manipulationEngine.debugMode ? 'ENABLED' : 'DISABLED');
            if (window.manipulationEngine.debugMode) {
              debugPanel.classList.add('active');
            }
          }
        }
      });
    });
  </script>

  <!-- Debug Panel -->
  <button class="debug-toggle" id="debugToggle" title="Toggle Debug Panel (Ctrl+D to enable debug mode)">üêõ</button>
  <div class="debug-panel" id="debugPanel">
    <div class="debug-header">
      <h3>Debug Log</h3>
      <div>
        <button class="debug-toggle" id="debugClear">Clear</button>
        <button class="debug-toggle" id="debugClose">√ó</button>
      </div>
    </div>
    <div class="debug-log" id="debugLog">
      <!-- Debug entries populated here -->
    </div>
    <div class="debug-footer">
      Press Ctrl+D (Cmd+D on Mac) to toggle debug mode
    </div>
  </div>

</body>
</html>

