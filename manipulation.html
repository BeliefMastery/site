<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manipulation Vector Identification - Belief Mastery</title>
  <meta name="description" content="Identify manipulation tactics and vectors through comprehensive symptom, effect, and consequence analysis. Based on the Tactical Manipulation Compendium from Sovereign of Mind.">
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    /* Page-specific styles for manipulation.html */
    body {
      background: var(--bg);
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('./images/manipulation-background.jpg');
      background-size: contain;
      background-attachment: fixed;
      background-repeat: no-repeat;
      background-position: center;
      z-index: 0;
      pointer-events: none;
    }

    body::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(180deg, rgba(0,0,0,0.08), rgba(0,0,0,0.14));
      z-index: 1;
      pointer-events: none;
    }

    .manipulation-container {
      position: relative;
      z-index: 2;
      max-width: 900px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
    }

    .intro-section {
      background: rgba(255, 255, 255, 0.95);
      border-radius: var(--radius);
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      border-left: 4px solid #d32f2f;
    }

    .intro-section h2 {
      color: #d32f2f;
      font-size: 1.75rem;
      margin-bottom: 1rem;
    }

    .questionnaire-section {
      background: rgba(255, 255, 255, 0.95);
      border-radius: var(--radius);
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      display: none;
    }

    .questionnaire-section.active {
      display: block;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: rgba(0, 0, 0, 0.1);
      border-radius: 4px;
      margin-bottom: 2rem;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #d32f2f, var(--accent));
      transition: width 0.3s ease;
      width: 0%;
    }

    .question-block {
      margin-bottom: 2rem;
    }

    .question-block h3 {
      margin-bottom: 1rem;
      color: #d32f2f;
      font-size: 1.25rem;
    }

    .scale-container {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .scale-input {
      flex: 1;
    }

    .scale-input input[type="range"] {
      width: 100%;
      height: 8px;
      border-radius: 4px;
      background: rgba(0, 0, 0, 0.1);
      outline: none;
      -webkit-appearance: none;
    }

    .scale-input input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #d32f2f;
      cursor: pointer;
    }

    .scale-input input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #d32f2f;
      cursor: pointer;
      border: none;
    }

    .scale-value {
      min-width: 40px;
      text-align: center;
      font-weight: 600;
      font-size: 1.25rem;
      color: #d32f2f;
    }

    .scale-labels {
      display: flex;
      justify-content: space-between;
      width: 100%;
      font-size: 0.85rem;
      color: var(--muted);
      margin-top: 0.5rem;
    }

    .navigation-buttons {
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      margin-top: 2rem;
    }

    .results-section {
      background: rgba(255, 255, 255, 0.95);
      border-radius: var(--radius);
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      display: none;
    }

    .results-section.active {
      display: block;
    }

    .results-section h2 {
      color: #d32f2f;
      margin-bottom: 1.5rem;
    }

    .vector-result {
      margin-bottom: 1.5rem;
      padding: 1.5rem;
      background: var(--glass);
      border-radius: var(--radius);
      border-left: 4px solid #d32f2f;
    }

    .vector-result h3 {
      color: #d32f2f;
      margin-bottom: 0.5rem;
    }

    .tactic-item {
      margin-top: 1rem;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.5);
      border-radius: var(--radius);
      border-left: 3px solid var(--brand);
    }

    .tactic-item strong {
      color: var(--brand);
    }

    .instructions-toggle {
      background: rgba(211, 47, 47, 0.1);
      border: 2px solid #d32f2f;
      border-radius: var(--radius);
      padding: 1rem 1.5rem;
      margin-bottom: 1.5rem;
      cursor: pointer;
      transition: var(--transition);
    }

    .instructions-toggle:hover {
      background: rgba(211, 47, 47, 0.15);
      box-shadow: 0 4px 12px rgba(211, 47, 47, 0.2);
    }

    .instructions-toggle-text {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-weight: 600;
      color: #d32f2f;
      font-size: 1rem;
    }

    .instructions-toggle-text::after {
      content: '‚ñº';
      font-size: 0.8rem;
      transition: transform 0.3s ease;
      margin-left: 0.5rem;
    }

    .instructions-toggle.expanded .instructions-toggle-text::after {
      transform: rotate(180deg);
    }

    .disclaimer-acknowledgement {
      background: rgba(255, 255, 255, 0.95);
      border-radius: var(--radius);
      padding: 1rem 1.5rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      border-left: 4px solid #d32f2f;
      cursor: pointer;
      transition: var(--transition);
    }

    .disclaimer-acknowledgement:hover {
      background: rgba(255, 255, 255, 0.98);
      box-shadow: 0 12px 40px rgba(0,0,0,0.12);
    }

    .disclaimer-acknowledgement-text {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-weight: 600;
      color: var(--brand);
      font-size: 1rem;
    }

    .disclaimer-acknowledgement-text::after {
      content: '‚ñº';
      font-size: 0.8rem;
      transition: transform 0.3s ease;
      margin-left: 0.5rem;
    }

    .disclaimer-acknowledgement.expanded .disclaimer-acknowledgement-text::after {
      transform: rotate(180deg);
    }

    .disclaimer-section {
      background: rgba(255, 255, 255, 0.95);
      border-radius: var(--radius);
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      border-left: 4px solid #d32f2f;
      max-height: 0;
      overflow: hidden;
      opacity: 0;
      transition: max-height 0.4s ease, opacity 0.3s ease, padding 0.3s ease, margin 0.3s ease;
      padding-top: 0;
      padding-bottom: 0;
      margin-top: 0;
      margin-bottom: 0;
    }

    .disclaimer-section.expanded {
      max-height: 2000px;
      opacity: 1;
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .instructions-panel {
      background: rgba(211, 47, 47, 0.1);
      border: 2px solid #d32f2f;
      border-radius: var(--radius);
      max-height: 0;
      overflow: hidden;
      opacity: 0;
      transition: max-height 0.4s ease, opacity 0.3s ease, padding 0.3s ease, margin 0.3s ease;
      padding-top: 0;
      padding-bottom: 0;
      margin-top: 0;
      margin-bottom: 0;
    }

    .instructions-panel.expanded {
      max-height: 2000px;
      opacity: 1;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .instructions-panel h3 {
      margin-bottom: 1rem;
      color: #d32f2f;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    /* New question type styles */
    .three-point-options, .binary-unsure-options, .frequency-options {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-top: 1.5rem;
    }

    .three-point-option, .binary-unsure-option, .frequency-option {
      display: flex;
      align-items: flex-start;
      padding: 1rem;
      background: var(--glass);
      border: 2px solid rgba(0, 0, 0, 0.1);
      border-radius: var(--radius);
      cursor: pointer;
      transition: var(--transition);
    }

    .three-point-option:hover, .binary-unsure-option:hover, .frequency-option:hover {
      background: rgba(255, 255, 255, 0.8);
      border-color: #d32f2f;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .three-point-option.selected, .binary-unsure-option.selected, .frequency-option.selected {
      background: rgba(211, 47, 47, 0.1);
      border-color: #d32f2f;
    }

    .three-point-option input[type="radio"],
    .binary-unsure-option input[type="radio"],
    .frequency-option input[type="radio"] {
      margin-right: 0.75rem;
      margin-top: 0.25rem;
      cursor: pointer;
    }

    .multiselect-options {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-top: 1.5rem;
    }

    .multiselect-option {
      display: flex;
      align-items: flex-start;
      padding: 1rem;
      background: var(--glass);
      border: 2px solid rgba(0, 0, 0, 0.1);
      border-radius: var(--radius);
      cursor: pointer;
      transition: var(--transition);
    }

    .multiselect-option:hover {
      background: rgba(255, 255, 255, 0.8);
      border-color: #d32f2f;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .multiselect-option.selected {
      background: rgba(211, 47, 47, 0.1);
      border-color: #d32f2f;
    }

    .multiselect-option input[type="checkbox"] {
      margin-right: 0.75rem;
      margin-top: 0.25rem;
      cursor: pointer;
    }

    .selection-limit {
      margin-top: 0.5rem;
      font-size: 0.9rem;
      color: var(--muted);
      font-style: italic;
    }

    .selection-count {
      margin-top: 1rem;
      padding: 0.75rem;
      background: rgba(211, 47, 47, 0.1);
      border-left: 3px solid #d32f2f;
      border-radius: var(--radius);
      font-weight: 600;
      color: #d32f2f;
    }

    .question-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }

    .question-number {
      font-size: 0.9rem;
      color: var(--muted);
      font-weight: 600;
    }

    .question-stage {
      font-size: 0.85rem;
      color: #d32f2f;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .question-text {
      margin-bottom: 1rem;
      color: #d32f2f;
      font-size: 1.25rem;
      line-height: 1.6;
    }

    .option-text {
      flex: 1;
      line-height: 1.6;
    }

    @media (max-width: 768px) {
      .manipulation-container {
        padding: 1rem;
      }

      .navigation-buttons {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
    <header class="site-header" role="banner">
    <nav class="nav" aria-label="Primary navigation">
      <button class="hamburger" aria-expanded="false" aria-controls="top-nav" aria-label="Toggle navigation">‚ò∞</button>
      <ul class="nav-list" id="top-nav" role="menubar">
        <li role="none"><a role="menuitem" href="index.html">Home</a></li>
        <li role="none" class="nav-dropdown">
          <a role="menuitem" href="books.html" class="dropdown-toggle">Books <span style="font-size:0.8em;">‚ñº</span></a>
          <ul class="dropdown-menu" role="menu">
            <li role="none"><a role="menuitem" href="books.html">All Books</a></li>
            <li role="none"><a role="menuitem" href="books.html#belief-mastery">Belief Mastery</a></li>
            <li role="none"><a role="menuitem" href="books.html#sovereign-of-mind">Sovereign of Mind</a></li>
            <li role="none"><a role="menuitem" href="books.html#distortion-codex">Distortion Codex</a></li>
            <li role="none"><a role="menuitem" href="books.html#unspeakables-grimoire">The Unspeakables Grimoire</a></li>
            <li role="none"><a role="menuitem" href="books.html#sovereign-integral-devotionalism">Sovereign Integral Devotionalism</a></li>
            <li role="none"><a role="menuitem" href="books.html#peer-counseling-manual">Peer-Counseling Manual</a></li>
          </ul>
        </li>
        <li role="none" class="nav-dropdown">
          <a role="menuitem" href="tools.html" class="dropdown-toggle">Tools <span style="font-size:0.8em;">‚ñº</span></a>
          <ul class="dropdown-menu" role="menu">
            <li role="none"><a role="menuitem" href="tools.html">All Tools</a></li>
            <li role="none"><a role="menuitem" href="https://chatgpt.com/g/g-684212ba47e081918d000ec3f9cf8f69-simulacrum-exorcist-edition" target="_blank">Sovereignty Simulacrum</a></li>
            <li role="none"><a role="menuitem" href="diagnosis.html">Diagnosis System</a></li>
            <li role="none"><a role="menuitem" href="coaching.html">Coaching Agent</a></li>
            <li role="none"><a role="menuitem" href="manipulation.html" class="active">Manipulation Analysis</a></li>
            <li role="none"><a role="menuitem" href="channels.html">Channel Analysis</a></li>
            <li role="none"><a role="menuitem" href="paradigm.html">Paradigm Clarification</a></li>
            <li role="none"><a role="menuitem" href="relationship.html">Relationship Optimization</a></li>
            <li role="none"><a role="menuitem" href="temperament.html">Temperament Analyzer</a></li>
            <li role="none"><a role="menuitem" href="needs-dependency.html">Needs Dependency Loop</a></li>
            <li role="none"><a role="menuitem" href="archetype.html">Archetype Analysis</a></li>
          </ul>
        </li>
        <li role="none"><a role="menuitem" href="about-the-author.html">About the Author</a></li>
      </ul>
    </nav>
  </header>

  <main style="position: relative; z-index: 2;">
    <div class="manipulation-container">
      <section class="intro-section">
        <h2>üõ°Ô∏è Manipulation Vector Identification</h2>
        <p style="font-size: 1.3rem; font-weight: 700; color: var(--brand); margin-bottom: 1.5rem; line-height: 1.5;">
          Are you being manipulated? Recognize the patterns and tactics being used against you. Identify the vectors and reclaim your sovereignty!
        </p>
        <div style="background: rgba(211, 47, 47, 0.1); border-left: 4px solid #d32f2f; border-radius: var(--radius); padding: 1.25rem; margin-bottom: 1.5rem;">
          <p style="margin: 0; font-size: 0.95rem; line-height: 1.7; color: var(--muted);"><strong style="color: #d32f2f;">Epistemic Note:</strong> This system identifies manipulation patterns based on reported effects. It does not determine intent, morality, or full relational context. The analysis maps patterns consistent with manipulation vectors‚Äînot accusations of manipulator identity.</p>
        </div>
        <p><strong>Identify patterns consistent with manipulation through comprehensive symptom, effect, and consequence analysis.</strong></p>
        <p>This system guides you through questions about symptoms, effects, situational developments, and consequences to identify which manipulation vectors show patterns consistent with your experiences. Based on the <strong>Tactical Manipulation Compendium</strong> from <em>Sovereign of Mind</em>, this tool helps you recognize patterns of coercion, control, and psychological sabotage.</p>
        <p style="margin-top: 1rem; font-weight: 600;">The assessment covers:</p>
        <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
          <li><strong>Symptoms:</strong> Emotional, behavioral, cognitive, relational, and physical indicators</li>
          <li><strong>Effects:</strong> Impact on self-worth, autonomy, relationships, and daily functioning</li>
          <li><strong>Consequences:</strong> Situational developments and long-term consequences</li>
        </ul>
        <div class="disclaimer-acknowledgement" id="disclaimerToggle">
          <div class="disclaimer-acknowledgement-text">
            <span>Disclaimers</span>
          </div>
        </div>
        <div style="background: rgba(255, 255, 255, 0.95); border-radius: var(--radius); padding: 1rem 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--shadow); backdrop-filter: blur(8px); border-left: 3px solid var(--accent);">
          <p style="margin: 0; font-size: 0.95rem; color: var(--muted); line-height: 1.6;">
            By participating in this analysis, I acknowledge that this tool is designed for self-awareness and recognition. Understanding manipulation patterns is the first step toward reclaiming sovereignty.
          </p>
        </div>
        <section class="disclaimer-section" id="disclaimerSection">
          <h3 style="color: #d32f2f; font-size: 1.2rem; margin-bottom: 1rem;">Important Note</h3>
          <p><strong>This tool is designed for self-awareness and recognition.</strong></p>
          <p style="margin-top: 1rem; line-height: 1.6; color: var(--muted);">Understanding manipulation patterns is the first step toward reclaiming sovereignty. Use this knowledge responsibly - awareness without integrity can become a tool of control.</p>
        </section>
        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
          <a href="example-reports/manipulation-example.html" target="_blank" class="btn btn-secondary" style="flex: 1; text-align: center; padding: 0.75rem 1.5rem; background: rgba(255, 255, 255, 0.9); border: 2px solid var(--brand); color: var(--brand); border-radius: var(--radius); text-decoration: none; font-weight: 600;">View Example Report</a>
          <button class="btn btn-primary" id="startAssessment" style="flex: 1;">Begin Manipulation Assessment</button>
        </div>
      </section>

      <section class="questionnaire-section" id="questionnaireSection">
        <div class="instructions-toggle" id="instructionsToggle">
          <div class="instructions-toggle-text">
            <span>üìã How to Use This Assessment</span>
          </div>
        </div>
        <div class="instructions-panel" id="instructionsPanel">
          <h3><span>üìã</span> How to Use This Assessment</h3>
          <div style="line-height: 1.7;">
            <p style="margin-bottom: 1rem;"><strong>Understanding the Scale (0-10):</strong></p>
            <ul style="margin-left: 1.5rem; margin-bottom: 1rem;">
              <li><strong>0-2 (Not at all / Never):</strong> The statement does not apply to you at all.</li>
              <li><strong>3-4 (Minimal / Rarely):</strong> The statement occurs occasionally but has minimal impact.</li>
              <li><strong>5-6 (Moderate / Sometimes):</strong> The statement is present with moderate frequency or intensity.</li>
              <li><strong>7-8 (Significant / Often):</strong> The statement occurs frequently or with significant intensity.</li>
              <li><strong>9-10 (Extreme / Always):</strong> The statement is nearly constant or extremely intense.</li>
            </ul>
            <p style="margin-bottom: 0.5rem;"><strong>Guidelines:</strong></p>
            <ul style="margin-left: 1.5rem; margin-bottom: 0;">
              <li>Answer based on your experience in the relationship(s) you're analyzing</li>
              <li>Be honest - recognition is the first step to protection</li>
              <li>Consider how each pattern affects your autonomy and well-being</li>
              <li>You can go back and change answers using the "Previous" button</li>
            </ul>
          </div>
        </div>

        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <div id="questionContainer">
          <!-- Questions will be populated by JavaScript -->
        </div>
        <div class="navigation-buttons">
          <button class="btn btn-secondary" id="prevQuestion" disabled>Previous</button>
          <button class="btn btn-primary" id="nextQuestion">Next</button>
        </div>
        <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid rgba(0,0,0,0.1); text-align: center;">
          <button class="btn btn-secondary" id="abandonAssessment" style="background: transparent; color: var(--muted); border: 1px solid var(--muted);">üóëÔ∏è Abandon / Restart</button>
        </div>
      </section>

      <section class="results-section" id="resultsSection">
        <h2>Manipulation Vector Analysis</h2>
        <div id="vectorResults">
          <!-- Results will be populated by JavaScript -->
        </div>
        <div style="margin-top: 2rem; padding-top: 2rem; border-top: 2px solid rgba(0, 0, 0, 0.1);">
          <h3>Export Your Analysis</h3>
          <p style="color: var(--muted); margin-bottom: 1rem;">Export your analysis for reference or professional consultation.</p>
          <button class="btn btn-primary" id="exportAnalysisJson">üì• Export Analysis (JSON)</button>
          <button class="btn btn-primary" id="exportAnalysisCsv" style="margin-left: 1rem;">üì• Export Analysis (CSV)</button>
          <button class="btn btn-secondary" id="newAssessment" style="margin-left: 1rem;">Start New Assessment</button>
        </div>
      </section>
    </div>
  </main>

  <footer class="site-footer" style="position: relative; z-index: 2;">
    <p>&copy; 2025 Warwick Marshall. All rights reserved.</p>
  </footer>

  <script type="module" src="manipulation-engine.js"></script>
  <script>
    // Hamburger menu functionality
    document.addEventListener('DOMContentLoaded', function() {
      // Disclaimer toggle functionality
      const disclaimerToggle = document.getElementById('disclaimerToggle');
      const disclaimerSection = document.getElementById('disclaimerSection');
      
      if (disclaimerToggle && disclaimerSection) {
        disclaimerToggle.addEventListener('click', function() {
          disclaimerToggle.classList.toggle('expanded');
          disclaimerSection.classList.toggle('expanded');
        });
      }

      // Instructions toggle functionality
      const instructionsToggle = document.getElementById('instructionsToggle');
      const instructionsPanel = document.getElementById('instructionsPanel');
      
      if (instructionsToggle && instructionsPanel) {
        instructionsToggle.addEventListener('click', function() {
          instructionsToggle.classList.toggle('expanded');
          instructionsPanel.classList.toggle('expanded');
        });
      }

      const hamburger = document.querySelector('.hamburger');
      const nav = document.getElementById('top-nav');
      const dropdownToggle = document.querySelector('.dropdown-toggle');
      const dropdownMenu = document.querySelector('.dropdown-menu');

      if (hamburger && nav) {
        hamburger.addEventListener('click', function() {
          const isExpanded = hamburger.getAttribute('aria-expanded') === 'true';
          hamburger.setAttribute('aria-expanded', !isExpanded);
          nav.classList.toggle('active');
        });
      }

      if (dropdownToggle && dropdownMenu) {
        dropdownToggle.addEventListener('click', function(e) {
          e.preventDefault();
          dropdownMenu.classList.toggle('active');
        });

        document.addEventListener('click', function(e) {
          if (!dropdownToggle.contains(e.target) && !dropdownMenu.contains(e.target)) {
            dropdownMenu.classList.remove('active');
          }
        });
      }
    });
  </script>

  <!-- Debug Panel -->
  <button class="debug-toggle" id="debugToggle" title="Toggle Debug Panel (Ctrl+D to enable debug mode)">üêõ</button>
  <div class="debug-panel" id="debugPanel">
    <div class="debug-header">
      <h3>Debug Log</h3>
      <div>
        <button class="debug-toggle" id="debugClear">Clear</button>
        <button class="debug-toggle" id="debugClose">‚úï</button>
      </div>
    </div>
    <div class="debug-log" id="debugLog">
      <!-- Debug entries will be populated here -->
    </div>
    <div class="debug-footer">
      Press Ctrl+D (Cmd+D on Mac) to toggle debug mode
    </div>
  </div>

  <script>
    // Debug panel toggle
    document.addEventListener('DOMContentLoaded', function() {
      const debugToggle = document.getElementById('debugToggle');
      const debugPanel = document.getElementById('debugPanel');
      const debugClose = document.getElementById('debugClose');
      const debugClear = document.getElementById('debugClear');
      const debugLog = document.getElementById('debugLog');
      
      if (debugToggle && debugPanel) {
        debugToggle.addEventListener('click', function() {
          debugPanel.classList.toggle('active');
        });
        
        if (debugClose) {
          debugClose.addEventListener('click', function() {
            debugPanel.classList.remove('active');
          });
        }
        
        if (debugClear && debugLog) {
          debugClear.addEventListener('click', function() {
            debugLog.innerHTML = '';
            if (window.manipulationEngine) {
              window.manipulationEngine.debugLog = [];
            }
          });
        }
      }
      
      // Enable debug mode with keyboard shortcut (Ctrl+D or Cmd+D)
      document.addEventListener('keydown', function(e) {
        if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
          e.preventDefault();
          if (window.manipulationEngine) {
            window.manipulationEngine.debugMode = !window.manipulationEngine.debugMode;
            console.log('Debug mode:', window.manipulationEngine.debugMode ? 'ENABLED' : 'DISABLED');
            if (window.manipulationEngine.debugMode) {
              debugPanel.classList.add('active');
            }
          }
        }
      });
    });
  </script>
</body>
</html>

