<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Villa Arrivals Dashboard</title>
<style>
:root {
  --teal: #00897b;
  --teal-dark: #00695c;
  --orange: #ff9800;
  --grey-bg: #f7f9fb;
  --grey-border: #e0e7ec;
  --grey-text: #444;
  --success: #2e7d32;
  --error: #d32f2f;
  --ongoing: #1976d2;
  font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
}

body {
  background: var(--grey-bg);
  margin: 0;
  color: var(--grey-text);
}

/* Header banner */
header {
  background: linear-gradient(135deg, var(--teal) 0%, var(--teal-dark) 100%);
  color: #fff;
  text-align: center;
  padding: 2.5rem 1rem 2rem;
  box-shadow: 0 6px 15px rgba(0,0,0,0.1);
}
header h1 {
  margin: 0;
  font-size: 2.2rem;
  font-weight: 700;
  letter-spacing: -0.02em;
}
header p {
  margin-top: .5rem;
  font-size: 1.05rem;
  opacity: 0.9;
}

/* Grid + cards */
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(270px, 1fr));
  gap: 1.2rem;
  padding: 1.5rem;
  max-width: 1200px;
  margin: 0 auto;
}

.card {
  background: linear-gradient(to bottom right, #fff, #f9fafb);
  border-left: 6px solid var(--orange);
  border-radius: 14px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.06);
  padding: 1.4rem 1.2rem 1.1rem;
  transition: transform .2s ease, box-shadow .2s ease;
}
.card:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 22px rgba(0,0,0,0.08);
}

/* Villa title hierarchy */
.villa-title {
  font-weight: 900;
  font-size: 2rem;
  color: var(--teal-dark);
  letter-spacing: -0.015em;
  border-bottom: 3px solid var(--orange);
  margin-bottom: 1rem;
  padding-bottom: 0.2rem;
}

/* Status and info lines */
.status-line {
  display: flex;
  align-items: center;
  font-size: 1.1rem;
  margin-top: 0.2rem;
}
.status-line i {
  margin-right: 0.6rem;
}

/* Colour states */
.arrival { color: var(--success); }
.ongoing { color: var(--ongoing); }
.no-arrival { color: var(--grey-text); opacity: 0.75; }
.error { color: var(--error); }

/* Debug footer */
.debug-bar {
  border-top: 1px solid var(--grey-border);
  background: #eef2f5;
  font-size: 0.9rem;
  padding: 0.6rem 1rem;
  color: #475569;
}
.debug-bar strong { color: var(--teal-dark); }
.debug-entry { margin-right: 1rem; display: inline-block; }
.status-success { color: var(--success); }
.status-ongoing { color: var(--ongoing); }
.status-noarrival { color: #999; }
.status-error { color: var(--error); }

/* Loading animation */
.loading-icon {
  display: inline-block;
  width: 18px; height: 18px;
  border: 2px solid rgba(255,255,255,0.4);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 1.1s ease-in-out infinite;
  margin-right: 0.5rem;
}
@keyframes spin { to { transform: rotate(360deg); } }
</style>
</head>

<body>
<header>
  <div class="loading-icon"></div>
  <h1>Villa Arrivals Dashboard</h1>
  <p>Automatic sync — Pacific/Auckland time</p>
</header>

<main class="grid" id="villaGrid"></main>

<footer class="debug-bar">
  <div id="debug"></div>
</footer>

<script>
const villas = [
  { id: 'villa1', name: 'Villa 1 · The Bay House' },
  { id: 'villa2', name: 'Villa 2 · Ocean View' },
  { id: 'villa3', name: 'Villa 3 · Garden Suite' },
  { id: 'villa4', name: 'Villa 4 · The Retreat' }
];

// Mock async fetch
function simulateFetch(villa) {
  const r = Math.random();
  return new Promise(res => {
    setTimeout(() => {
      if (r < 0.2) res({status:'error', reason:'Network unreachable'});
      else if (r < 0.4) res({status:'noarrival'});
      else if (r < 0.6) res({status:'ongoing'});
      else res({status:'success', guest:'Jane Doe', nights:2});
    }, 400 + Math.random()*800);
  });
}

async function loadAll() {
  const grid = document.getElementById('villaGrid');
  const debug = document.getElementById('debug');
  grid.innerHTML = '';
  debug.innerHTML = '';
  const results = [];

  for (const v of villas) {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `<div class="villa-title">${v.name}</div>
      <div class="status-line">Loading...</div>`;
    grid.appendChild(card);

    const res = await simulateFetch(v);
    let html='', dbg='';
    const now = new Date().toLocaleTimeString('en-NZ',{hour12:false});
    switch(res.status){
      case 'success':
        html = `<div class="status-line arrival"><i>✔</i> Arrival Today: ${res.guest} (${res.nights} nights)</div>`;
        dbg = `<span class='debug-entry status-success'>${v.id}: ✔ Arrival (${now})</span>`;
        break;
      case 'ongoing':
        html = `<div class="status-line ongoing"><i>⟳</i> Room occupied · Ongoing stay</div>`;
        dbg = `<span class='debug-entry status-ongoing'>${v.id}: ⟳ Ongoing stay (${now})</span>`;
        break;
      case 'noarrival':
        html = `<div class="status-line no-arrival"><i>–</i> No arrivals today</div>`;
        dbg = `<span class='debug-entry status-noarrival'>${v.id}: – No arrivals (${now})</span>`;
        break;
      case 'error':
        html = `<div class="status-line error"><i>✖</i> Data fetch error: ${res.reason}</div>`;
        dbg = `<span class='debug-entry status-error'>${v.id}: ✖ Fetch fail (${res.reason})</span>`;
        break;
    }
    card.querySelector('.status-line').outerHTML = html;
    results.push(dbg);
  }
  const now = new Date().toLocaleTimeString('en-NZ',{hour12:false});
  debug.innerHTML = `<strong>Last refresh:</strong> ${now} | ${results.join(' ')}`;
}

loadAll();
setInterval(loadAll, 120000); // refresh every 2 mins
</script>
</body>
</html>
